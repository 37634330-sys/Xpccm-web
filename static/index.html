<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÈÖ∑ÁõëÊéß - ÁΩëÁ´ôÁä∂ÊÄÅÁõëÊéß</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* Ê∑±Ëâ≤‰∏ªÈ¢òÔºàÈªòËÆ§Ôºâ */
        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-card: #1c2128;
            --bg-hover: #252d38;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --border-color: #30363d;
            --accent-green: #00a33c;
            --accent-green-light: #00b844;
            --accent-red: #f85149;
            --accent-yellow: #d29922;
            --accent-blue: #58a6ff;
            --accent-purple: #a371f7;
            --accent-orange: #db6d28;
            --shadow: 0 8px 24px rgba(0,0,0,0.4);
        }
        
        /* ÊµÖËâ≤‰∏ªÈ¢ò */
        [data-theme="light"] {
            --bg-primary: #f6f8fa;
            --bg-secondary: #ffffff;
            --bg-card: #ffffff;
            --bg-hover: #f3f4f6;
            --text-primary: #1f2328;
            --text-secondary: #57606a;
            --text-muted: #8b949e;
            --border-color: #d0d7de;
            --accent-green: #00a33c;
            --accent-green-light: #00b844;
            --accent-red: #cf222e;
            --accent-yellow: #9a6700;
            --accent-blue: #0969da;
            --accent-purple: #8250df;
            --accent-orange: #bc4c00;
            --shadow: 0 8px 24px rgba(0,0,0,0.1);
        }
        
        /* ÊµÖËâ≤‰∏ªÈ¢òÊåâÈíÆÊ†∑Âºè */
        [data-theme="light"] .btn-primary {
            background: var(--accent-green);
            color: #fff;
        }
        
        [data-theme="light"] .btn-secondary {
            background: #ffffff;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }
        
        [data-theme="light"] .btn-secondary:hover {
            background: var(--bg-hover);
            border-color: var(--accent-green);
        }
        
        [data-theme="light"] .btn-icon {
            background: #ffffff;
            border: 1px solid var(--border-color);
        }
        
        [data-theme="light"] .stat-card {
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }
        
        [data-theme="light"] .monitor-card {
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }
        
        [data-theme="light"] .refresh-bar {
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* ‰∏ªÈ°µÈù¢ - Âç°ÁâáÂàóË°® */
        .home-page {
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            flex: 1;
        }

        .page-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-green);
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            border: none;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--accent-green);
            color: #000;
        }

        .btn-primary:hover {
            background: var(--accent-green-light);
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }
        
        .btn-icon {
            width: 40px;
            height: 40px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }
        
        .btn-icon:hover {
            border-color: var(--accent-yellow);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        /* ÁªüËÆ°Âç°Áâá */
        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-card);
            border-radius: 12px;
            padding: 16px 20px;
            border: 2px solid transparent;
        }
        
        .stat-card:hover {
            border-color: var(--border-color);
            transform: translateY(-2px);
        }
        
        .stat-card.active {
            border-color: var(--accent-green);
            background: rgba(63, 185, 80, 0.05);
        }

        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }

        .stat-value.green { color: var(--accent-green); }
        .stat-value.red { color: var(--accent-red); }
        .stat-value.yellow { color: var(--accent-yellow); }
        .stat-value.blue { color: var(--accent-blue); }

        /* ÁõëÊéßÂç°ÁâáÁΩëÊ†º */
        .monitors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
            gap: 16px;
        }

        /* Âçï‰∏™ÁõëÊéßÂç°Áâá */
        .monitor-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px 24px;
            border: 1px solid var(--border-color);
            transition: all 0.2s;
        }

        .monitor-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            border-color: var(--accent-green);
        }

        .card-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .card-title-section {
            flex: 1;
        }

        .card-status-icon {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
            flex-shrink: 0;
            font-size: 10px;
        }

        .card-status-icon.online {
            background: var(--accent-green);
            color: #000;
        }

        .card-status-icon.offline {
            background: var(--accent-red);
            color: #fff;
        }

        .card-title {
            display: flex;
            align-items: center;
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--text-primary);
        }

        .card-tags {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-bottom: 4px;
        }

        .card-tag {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 4px;
            background: transparent;
            color: var(--text-muted);
        }

        .card-tag.method {
            color: var(--accent-blue);
        }

        .card-tag.type {
            color: var(--accent-purple);
        }
        
        .card-type-line {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 16px;
        }
        
        /* SSLËØÅ‰π¶Âå∫Âüü */
        .ssl-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            margin-bottom: 16px;
            border-radius: 10px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
        }
        
        .ssl-section.ssl-safe {
            background: rgba(63, 185, 80, 0.08);
            border-color: rgba(63, 185, 80, 0.3);
        }
        
        .ssl-section.ssl-warning {
            background: rgba(210, 153, 34, 0.08);
            border-color: rgba(210, 153, 34, 0.3);
        }
        
        .ssl-section.ssl-danger {
            background: rgba(248, 81, 73, 0.08);
            border-color: rgba(248, 81, 73, 0.3);
        }
        
        .ssl-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .ssl-icon-large {
            font-size: 20px;
        }
        
        .ssl-label {
            font-size: 13px;
            color: var(--text-secondary);
        }
        
        .ssl-right {
            display: flex;
            align-items: baseline;
            gap: 4px;
        }
        
        .ssl-days-large {
            font-size: 24px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .ssl-safe .ssl-days-large { color: var(--accent-green); }
        .ssl-warning .ssl-days-large { color: var(--accent-yellow); }
        .ssl-danger .ssl-days-large { color: var(--accent-red); }
        
        .ssl-unit {
            font-size: 14px;
            color: var(--text-muted);
        }
        
        /* ‰ø°ÊÅØË°å */
        .card-info-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 12px;
            color: var(--text-muted);
        }

        /* ÂúÜÁéØËøõÂ∫¶Êù° */
        .uptime-section {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .uptime-ring {
            position: relative;
            width: 40px;
            height: 40px;
            flex-shrink: 0;
        }

        .uptime-ring svg {
            transform: rotate(-90deg);
        }

        .uptime-ring-bg {
            fill: none;
            stroke: var(--bg-hover);
            stroke-width: 4;
        }

        .uptime-ring-progress {
            fill: none;
            stroke: var(--accent-green);
            stroke-width: 4;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s;
        }

        .uptime-ring-progress.warning {
            stroke: var(--accent-yellow);
        }

        .uptime-ring-progress.danger {
            stroke: var(--accent-red);
        }

        .uptime-text {
            font-size: 14px;
            font-weight: 500;
            color: var(--accent-green);
            font-family: 'JetBrains Mono', monospace;
        }
        
        .uptime-text.warning {
            color: var(--accent-yellow);
        }
        
        .uptime-text.danger {
            color: var(--accent-red);
        }

        /* ÁªüËÆ°‰ø°ÊÅØË°å */
        .card-stats-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 12px;
            font-size: 12px;
            color: var(--text-muted);
        }

        .card-stats {
            display: flex;
            align-items: center;
            gap: 16px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
        }

        .card-stat {
            white-space: nowrap;
        }
        
        .stat-value-green {
            color: var(--accent-green);
            font-weight: 500;
        }

        .status-legend {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 11px;
            color: var(--text-muted);
            flex-shrink: 0;
        }

        .legend-item {
            display: inline-flex;
            align-items: center;
            gap: 3px;
            white-space: nowrap;
        }

        .legend-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .legend-dot.online { background: var(--accent-green); }
        .legend-dot.maintenance { background: var(--accent-yellow); }
        .legend-dot.offline { background: var(--accent-red); }

        /* Áä∂ÊÄÅÂéÜÂè≤Êù° */
        .status-bar-section {
            margin-bottom: 20px;
        }

        .status-bars {
            display: flex;
            gap: 2px;
            height: 24px;
            align-items: stretch;
        }

        .status-bar {
            flex: 1;
            border-radius: 2px;
            min-width: 3px;
            transition: transform 0.2s;
        }

        .status-bar:hover {
            transform: scaleY(1.15);
        }

        .status-bar.online { background: var(--accent-green); }
        .status-bar.offline { background: var(--accent-red); }
        .status-bar.pending { background: var(--bg-hover); }

        /* ÂàÜÈöîÁ∫ø */
        .card-divider {
            height: 1px;
            background: var(--border-color);
            margin: 16px 0;
        }

        /* Êó∂Èó¥ËåÉÂõ¥ÂàáÊç¢ */
        .range-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            justify-content: center;
        }

        .range-tab {
            padding: 6px 14px;
            font-size: 12px;
            background: var(--bg-secondary);
            color: var(--text-muted);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .range-tab:hover {
            color: var(--text-primary);
            border-color: var(--text-muted);
        }

        .range-tab.active {
            background: var(--border-color);
            color: var(--text-primary);
            border-color: var(--border-color);
            font-weight: 500;
        }

        /* ÂìçÂ∫îÊó∂Èó¥ÂõæË°® */
        .chart-wrapper {
            display: flex;
            gap: 8px;
        }

        .chart-y-labels {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            font-size: 10px;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
            min-width: 50px;
            text-align: right;
            padding: 2px 0;
        }

        .chart-main {
            flex: 1;
            min-width: 0;
        }

        .chart-canvas {
            width: 100%;
            height: 80px;
            display: block;
        }

        .chart-x-labels {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: var(--text-muted);
            margin-top: 4px;
            font-family: 'JetBrains Mono', monospace;
        }

        /* ========== ËØ¶ÊÉÖÈ°µ ========== */
        .detail-page {
            display: none;
            height: 100vh;
        }

        .detail-page.active {
            display: flex;
        }

        .home-page.hidden {
            display: none;
        }

        /* Â∑¶‰æßËæπÊ†è */
        .sidebar {
            width: 280px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .sidebar-logo {
            font-size: 20px;
            font-weight: 700;
            color: var(--accent-green);
            margin-bottom: 16px;
        }

        .sidebar-add-btn {
            width: 100%;
            padding: 12px;
            background: var(--accent-green);
            color: #000;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .sidebar-add-btn:hover {
            background: var(--accent-green-light);
        }

        .sidebar-search {
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .search-input {
            width: 100%;
            padding: 10px 12px;
            padding-left: 36px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236e7681'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: 10px center;
            background-size: 16px;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-green);
        }

        .sidebar-title {
            padding: 16px 20px 8px;
            font-size: 12px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .sidebar-list {
            flex: 1;
            overflow-y: auto;
            padding: 0 12px 20px;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 4px;
        }

        .sidebar-item:hover {
            background: var(--bg-hover);
        }

        .sidebar-item.active {
            background: var(--bg-hover);
            border-left: 3px solid var(--accent-green);
        }

        .sidebar-item-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: var(--bg-card);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 14px;
        }

        .sidebar-item-content {
            flex: 1;
            min-width: 0;
        }

        .sidebar-item-name {
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .sidebar-item-status {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .sidebar-item-status.online {
            background: var(--accent-green);
            box-shadow: 0 0 8px var(--accent-green);
        }

        .sidebar-item-status.offline {
            background: var(--accent-red);
        }

        /* Âè≥‰æß‰∏ªÂÜÖÂÆπÂå∫ */
        .main-content {
            flex: 1;
            overflow-y: auto;
            background: var(--bg-primary);
        }

        .content-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: var(--bg-secondary);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .content-nav {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .back-btn {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: transparent;
            color: var(--text-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .back-btn:hover {
            background: var(--bg-hover);
        }

        .content-title {
            font-size: 18px;
            font-weight: 600;
        }

        .content-subtitle {
            font-size: 13px;
            color: var(--text-muted);
        }

        .content-actions {
            display: flex;
            gap: 8px;
        }

        .icon-btn {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .icon-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        /* Áä∂ÊÄÅÁªüËÆ°Êù° */
        .status-stats {
            display: flex;
            gap: 16px;
            padding: 20px 24px;
            background: var(--bg-secondary);
            flex-wrap: wrap;
        }

        .status-stat {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 16px 24px;
            border: 1px solid var(--border-color);
            min-width: 120px;
            flex: 1;
        }

        .status-stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .status-stat-label {
            font-size: 14px;
        }

        .status-stat-label.green { color: var(--accent-green); }
        .status-stat-label.red { color: var(--accent-red); }
        .status-stat-label.yellow { color: var(--accent-yellow); }
        .status-stat-label.blue { color: var(--accent-blue); }
        .status-stat-label.purple { color: var(--accent-purple); }

        .status-stat-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .status-stat-icon.green { background: rgba(63, 185, 80, 0.2); color: var(--accent-green); }
        .status-stat-icon.red { background: rgba(248, 81, 73, 0.2); color: var(--accent-red); }
        .status-stat-icon.yellow { background: rgba(210, 153, 34, 0.2); color: var(--accent-yellow); }
        .status-stat-icon.blue { background: rgba(88, 166, 255, 0.2); color: var(--accent-blue); }
        .status-stat-icon.purple { background: rgba(163, 113, 247, 0.2); color: var(--accent-purple); }

        .status-stat-value {
            font-size: 28px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }

        /* ÂéÜÂè≤ËÆ∞ÂΩïË°®Ê†º */
        .history-section {
            padding: 24px;
        }

        .section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .history-table {
            width: 100%;
            background: var(--bg-card);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .history-table th,
        .history-table td {
            padding: 14px 16px;
            text-align: left;
        }

        .history-table th {
            background: var(--bg-hover);
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .history-table td {
            border-bottom: 1px solid var(--border-color);
            font-size: 14px;
        }

        .history-table tr:last-child td {
            border-bottom: none;
        }

        .history-table tr:hover td {
            background: var(--bg-hover);
        }

        .table-name {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--accent-blue);
            cursor: pointer;
        }

        .table-name:hover {
            text-decoration: underline;
        }

        .table-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
        }

        .table-status.online {
            background: rgba(63, 185, 80, 0.15);
            color: var(--accent-green);
        }

        .table-status.offline {
            background: rgba(248, 81, 73, 0.15);
            color: var(--accent-red);
        }

        .table-status.paused {
            background: rgba(163, 113, 247, 0.15);
            color: var(--accent-purple);
        }

        .table-time {
            color: var(--text-secondary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
        }

        .table-message {
            color: var(--text-secondary);
        }

        /* Ê®°ÊÄÅÊ°Ü */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            padding: 20px;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background: var(--bg-card);
            border-radius: 16px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }

        .modal-close {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: none;
            background: var(--bg-hover);
            cursor: pointer;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-body {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 6px;
            color: var(--text-secondary);
        }

        .form-input, .form-select {
            width: 100%;
            padding: 10px 14px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-green);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .type-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
            gap: 8px;
        }

        .type-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-secondary);
        }

        .type-checkbox:hover {
            border-color: var(--accent-green);
        }

        .type-checkbox.selected {
            border-color: var(--accent-green);
            background: rgba(63, 185, 80, 0.1);
        }

        .type-checkbox-icon {
            font-size: 16px;
        }

        .type-checkbox-label {
            font-size: 13px;
        }
        
        /* ÈÄöÁü•Ê∏†ÈÅìÊ†∑Âºè */
        .notify-desc {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 12px;
            line-height: 1.5;
        }
        
        .notify-hint {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 16px;
            padding: 10px 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border-left: 3px solid var(--accent-blue);
        }
        
        .notify-hint code {
            background: var(--bg-hover);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            color: var(--accent-green);
        }
        
        .notify-code {
            width: 100%;
            min-height: 200px;
            padding: 14px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            line-height: 1.5;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            resize: vertical;
        }
        
        .notify-code:focus {
            outline: none;
            border-color: var(--accent-green);
        }
        
        .notify-code::placeholder {
            color: var(--text-muted);
        }
        
        .btn-warning {
            background: var(--accent-yellow);
            color: #000;
        }
        
        .btn-warning:hover {
            background: #e0a800;
        }
        
        /* ÈÄöÁü•Ê∏†ÈÅìÈÄâÊã©ÂàóË°® */
        .notify-settings-desc {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 12px;
        }
        
        .notify-channels-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .notify-channel-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 14px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .notify-channel-item:hover {
            border-color: var(--accent-blue);
        }
        
        .notify-channel-item:has(.notify-checkbox:checked) {
            border-color: var(--accent-blue);
            background: rgba(88, 166, 255, 0.08);
        }
        
        .notify-checkbox {
            width: 18px;
            height: 18px;
            accent-color: var(--accent-blue);
            cursor: pointer;
        }
        
        .notify-channel-icon {
            font-size: 20px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-hover);
            border-radius: 8px;
        }
        
        .notify-channel-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .notify-channel-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .notify-channel-type {
            font-size: 11px;
            color: var(--text-muted);
        }
        
        .notify-settings-hint {
            font-size: 11px;
            color: var(--accent-yellow);
            margin: 0;
        }
        
        /* ÈÄöÁü•Ê∏†ÈÅìÁÆ°ÁêÜ */
        .notify-channels-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        
        .notify-channels-header .notify-desc {
            margin: 0;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 12px;
        }
        
        .notify-channels-manage {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .empty-channels {
            text-align: center;
            padding: 30px;
            color: var(--text-muted);
            font-size: 13px;
        }
        
        .channel-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 14px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
        }
        
        .channel-item-icon {
            font-size: 20px;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-hover);
            border-radius: 8px;
        }
        
        .channel-item-info {
            flex: 1;
        }
        
        .channel-item-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .channel-item-type {
            font-size: 11px;
            color: var(--text-muted);
        }
        
        .channel-item-actions {
            display: flex;
            gap: 8px;
        }
        
        .channel-item-actions button {
            padding: 4px 10px;
            font-size: 11px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-edit {
            background: var(--accent-blue);
            color: #fff;
        }
        
        .btn-delete {
            background: var(--accent-red);
            color: #fff;
        }
        
        /* Ê∏†ÈÅìË°®Âçï */
        .channel-form {
            padding: 16px;
            background: var(--bg-hover);
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }
        
        .channel-form-header {
            margin-bottom: 16px;
        }
        
        .channel-form-header h4 {
            margin: 0;
            font-size: 15px;
            color: var(--text-primary);
        }
        
        .channel-form-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
            margin-top: 16px;
        }

        .modal-footer {
            padding: 16px 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* Âà∑Êñ∞ÊéßÂà∂Ê†è */
        .refresh-bar {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 12px 20px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        .refresh-progress-section {
            flex: 1;
        }
        
        .refresh-progress-bar {
            height: 6px;
            background: var(--bg-hover);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 6px;
        }
        
        .refresh-progress-fill {
            height: 100%;
            background: var(--accent-blue);
            border-radius: 3px;
            transition: width 1s linear;
            width: 0%;
        }
        
        .refresh-info {
            font-size: 12px;
            color: var(--text-muted);
        }
        
        .refresh-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .refresh-countdown {
            font-size: 12px;
            color: var(--text-muted);
            min-width: 100px;
            text-align: right;
        }
        
        .btn-refresh {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            font-size: 12px;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn-refresh:hover {
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }
        
        .btn-refresh.paused {
            background: rgba(210, 153, 34, 0.1);
            border-color: var(--accent-yellow);
            color: var(--accent-yellow);
        }

        /* Toast */
        .toast-container {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 1001;
        }

        .toast {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 14px 20px;
            margin-bottom: 12px;
            box-shadow: var(--shadow);
            animation: slideIn 0.3s ease;
        }

        .toast.success { border-left: 4px solid var(--accent-green); }
        .toast.error { border-left: 4px solid var(--accent-red); }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* ÂìçÂ∫îÂºè - Âπ≥ÊùøÁ´Ø */
        @media (max-width: 1024px) {
            .monitors-grid {
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            }
        }
        
        /* ÂìçÂ∫îÂºè - ÊâãÊú∫Á´Ø */
        @media (max-width: 768px) {
            .home-page {
                padding: 12px;
            }
            
            .page-header {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }
            
            .logo {
                text-align: center;
            }
            
            .header-actions {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .monitors-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .stats-row {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .stat-card {
                padding: 12px 14px;
            }
            
            .stat-value {
                font-size: 24px;
            }
            
            .refresh-bar {
                flex-direction: column;
                gap: 12px;
                padding: 12px 16px;
            }
            
            .refresh-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .refresh-countdown {
                text-align: left;
                min-width: auto;
            }
            
            .card-stats-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            
            .range-tabs {
                gap: 8px;
            }
            
            .range-tab {
                padding: 5px 10px;
                font-size: 11px;
            }

            .detail-page {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                max-height: 40vh;
                border-right: none;
                border-bottom: 1px solid var(--border-color);
            }

            .sidebar-list {
                max-height: 200px;
            }

            .main-content {
                flex: 1;
            }

            .status-stats {
                flex-wrap: wrap;
            }

            .status-stat {
                min-width: calc(50% - 8px);
                flex: none;
            }

            .history-table {
                display: block;
                overflow-x: auto;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
            
            .modal {
                margin: 10px;
                max-height: 95vh;
            }
            
            .btn {
                padding: 10px 16px;
                font-size: 13px;
            }

            .content-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .content-actions {
                width: 100%;
                justify-content: flex-end;
            }

            .mobile-menu-btn {
                display: block;
            }
        }

        /* Âä†ËΩΩÁä∂ÊÄÅ */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-color);
            border-top-color: var(--accent-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Á©∫Áä∂ÊÄÅ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        /* ÈöêËóèÁ±ª */
        .hidden {
            display: none !important;
        }
        
        /* Â∫ïÈÉ®ÁâàÊùÉ */
        .footer {
            text-align: center;
            padding: 24px;
            margin-top: 32px;
            border-top: 1px solid var(--border-color);
            color: var(--text-muted);
            font-size: 13px;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-primary);
        }
        
        /* ÁªôÂ∫ïÈÉ®ÁïôÂá∫Á©∫Èó¥ */
        .monitors-grid {
            padding-bottom: 80px;
        }
        
        .footer a {
            color: var(--text-secondary);
            text-decoration: none;
        }
        
        .footer a:hover {
            color: var(--accent-green);
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <!-- ‰∏ªÈ°µ - Âç°ÁâáÂàóË°® -->
    <div class="home-page" id="homePage">
        <div class="page-header">
            <div class="logo">üöÄ ÈÖ∑ÁõëÊéß</div>
            <div class="header-actions">
                <span style="color: var(--text-muted); font-size: 13px;" id="lastUpdate">--</span>
                <button class="btn btn-icon" onclick="toggleTheme()" id="themeBtn" title="ÂàáÊç¢‰∏ªÈ¢ò">
                    üåô
                </button>
                <a href="/admin" class="btn btn-icon" title="ÂêéÂè∞ÁÆ°ÁêÜ" style="text-decoration: none;">
                    ‚öôÔ∏è
                </a>
            </div>
        </div>

        <!-- ÁªüËÆ° -->
        <div class="stats-row">
            <div class="stat-card active" onclick="filterByStatus('all')" id="filterAll">
                <div class="stat-label">üìä ÁõëÊéßÊÄªÊï∞</div>
                <div class="stat-value" id="statTotal">0</div>
            </div>
            <div class="stat-card" onclick="filterByStatus('online')" id="filterOnline">
                <div class="stat-label">‚úÖ Ê≠£Â∏∏</div>
                <div class="stat-value green" id="statOnline">0</div>
            </div>
            <div class="stat-card" onclick="filterByStatus('offline')" id="filterOffline">
                <div class="stat-label">‚ùå ÊïÖÈöú</div>
                <div class="stat-value red" id="statOffline">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">üìà Âπ≥ÂùáÂèØÁî®Áéá</div>
                <div class="stat-value blue" id="statUptime">0%</div>
            </div>
        </div>

        <!-- Âà∑Êñ∞ÊéßÂà∂Ê†è -->
        <div class="refresh-bar">
            <div class="refresh-progress-section">
                <div class="refresh-progress-bar">
                    <div class="refresh-progress-fill" id="refreshProgress"></div>
                </div>
                <div class="refresh-info">‰∏äÊ¨°Âà∑Êñ∞: <span id="lastRefreshTime">--</span></div>
            </div>
            <div class="refresh-actions">
                <span class="refresh-countdown" id="refreshCountdown">Â∞ÜÂú® 60 ÁßíÂêéÂà∑Êñ∞</span>
                <button class="btn-refresh" id="pauseBtn" onclick="togglePause()">
                    <span id="pauseIcon">‚è∏</span> <span id="pauseText">ÊöÇÂÅú</span>
                </button>
                <button class="btn-refresh" onclick="manualRefresh()">
                    üîÑ Á´ãÂç≥Âà∑Êñ∞
                </button>
            </div>
        </div>

        <!-- ÁõëÊéßÂç°ÁâáÁΩëÊ†º -->
        <div class="monitors-grid" id="monitorsGrid">
            <div class="loading"><div class="spinner"></div></div>
        </div>
        
        <!-- Â∫ïÈÉ®ÁâàÊùÉ -->
        <div class="footer" id="siteFooter">
            <div class="footer-links">
                <a href="/admin">ÂêéÂè∞ÁÆ°ÁêÜ</a>
                <span>¬∑</span>
                <span>by <span id="footerAuthor">Xpccm</span></span>
            </div>
            <div id="footerIcp"></div>
        </div>
    </div>

    <!-- ËØ¶ÊÉÖÈ°µ -->
    <div class="detail-page" id="detailPage">
        <!-- Â∑¶‰æßËæπÊ†è -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">üöÄ ÈÖ∑ÁõëÊéß</div>
                <button class="sidebar-add-btn" onclick="openAddModal()">+ Ê∑ªÂä†ÁõëÊéßÈ°π</button>
            </div>
            <div class="sidebar-search">
                <input type="text" class="search-input" placeholder="ÊêúÁ¥¢ÁõëÊéßÈ°π..." id="sidebarSearch" oninput="filterSidebarItems()">
            </div>
            <div class="sidebar-title" id="sidebarTitle">ÁõëÊéßÁ±ªÂûã</div>
            <div class="sidebar-list" id="sidebarList">
                <!-- Âä®ÊÄÅÂ°´ÂÖÖ -->
            </div>
        </div>

        <!-- Âè≥‰æß‰∏ªÂÜÖÂÆπ -->
        <div class="main-content">
            <div class="content-header">
                <div class="content-nav">
                    <button class="back-btn" onclick="goHome()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                    </button>
                    <div>
                        <div class="content-title" id="detailTitle">ÁõëÊéßÂêçÁß∞</div>
                        <div class="content-subtitle" id="detailSubtitle">Áä∂ÊÄÅÈÄüËßà</div>
                    </div>
                </div>
                <div class="content-actions">
                    <button class="icon-btn" onclick="refreshCurrentMonitor()" title="Âà∑Êñ∞">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
                        </svg>
                    </button>
                    <button class="icon-btn" onclick="editCurrentMonitor()" title="ÁºñËæë">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                        </svg>
                    </button>
                    <button class="icon-btn" onclick="deleteCurrentMonitor()" title="Âà†Èô§" style="color: var(--accent-red);">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Áä∂ÊÄÅÁªüËÆ° -->
            <div class="status-stats" id="statusStats">
                <div class="status-stat">
                    <div class="status-stat-header">
                        <span class="status-stat-label green">Ê≠£Â∏∏</span>
                        <span class="status-stat-icon green">‚úì</span>
                    </div>
                    <div class="status-stat-value" id="detailOnline">0</div>
                </div>
                <div class="status-stat">
                    <div class="status-stat-header">
                        <span class="status-stat-label red">ÊïÖÈöú</span>
                        <span class="status-stat-icon red">!</span>
                    </div>
                    <div class="status-stat-value" id="detailOffline">0</div>
                </div>
                <div class="status-stat">
                    <div class="status-stat-header">
                        <span class="status-stat-label yellow">Áª¥Êä§</span>
                        <span class="status-stat-icon yellow">üîß</span>
                    </div>
                    <div class="status-stat-value">0</div>
                </div>
                <div class="status-stat">
                    <div class="status-stat-header">
                        <span class="status-stat-label blue">Êú™Áü•</span>
                        <span class="status-stat-icon blue">?</span>
                    </div>
                    <div class="status-stat-value" id="detailUnknown">0</div>
                </div>
                <div class="status-stat">
                    <div class="status-stat-header">
                        <span class="status-stat-label purple">ÊöÇÂÅú</span>
                        <span class="status-stat-icon purple">‚è∏</span>
                    </div>
                    <div class="status-stat-value" id="detailPaused">0</div>
                </div>
            </div>

            <!-- ÂéÜÂè≤ËÆ∞ÂΩï -->
            <div class="history-section">
                <div class="section-title">üìã Ê£ÄÊµãÂéÜÂè≤</div>
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>ÂêçÁß∞</th>
                            <th>Áä∂ÊÄÅ</th>
                            <th>Êó•ÊúüÊó∂Èó¥</th>
                            <th>Ê∂àÊÅØ</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <!-- Âä®ÊÄÅÂ°´ÂÖÖ -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Ê∑ªÂä†/ÁºñËæëÊ®°ÊÄÅÊ°Ü -->
    <div class="modal-overlay" id="monitorModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Ê∑ªÂä†ÁõëÊéß</h3>
                <button class="modal-close" onclick="closeModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <form id="monitorForm">
                    <input type="hidden" id="monitorId">
                    
                    <div class="form-group">
                        <label class="form-label">ÁõëÊéßÂêçÁß∞ *</label>
                        <input type="text" class="form-input" id="monitorName" placeholder="‰æãÂ¶ÇÔºöÊàëÁöÑÁΩëÁ´ô" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ÁõëÊéßÁ±ªÂûãÔºàÂèØÂ§öÈÄâÔºâ</label>
                        <div class="type-checkboxes" id="typeCheckboxes">
                            <label class="type-checkbox" data-type="http">
                                <span class="type-checkbox-icon">üåê</span>
                                <span class="type-checkbox-label">HTTP(s)ÁõëÊéß</span>
                            </label>
                            <label class="type-checkbox" data-type="ssl">
                                <span class="type-checkbox-icon">üîí</span>
                                <span class="type-checkbox-label">SSLËØÅ‰π¶ÁõëÊéß</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ÁõëÊéßÂú∞ÂùÄ *</label>
                        <input type="text" class="form-input" id="monitorTarget" placeholder="https://example.com" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Ê£ÄÊµãÈó¥ÈöîÔºàÁßíÔºâ</label>
                            <input type="number" class="form-input" id="monitorInterval" value="60" min="10">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Ë∂ÖÊó∂Êó∂Èó¥ÔºàÁßíÔºâ</label>
                            <input type="number" class="form-input" id="monitorTimeout" value="30" min="5">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">ÈÄöÁü•ËÆæÁΩÆ</label>
                        <p class="notify-settings-desc">ÈÄâÊã©ÂΩìÂâçÁõëÊéßÈ°πËß¶ÂèëÂëäË≠¶Êó∂Ë¶ÅÈÄöÁü•ÁöÑÊñπÂºè</p>
                        <div class="notify-channels-list" id="notifyChannelsList">
                            <label class="notify-channel-item">
                                <input type="checkbox" class="notify-checkbox" value="webhook">
                                <span class="notify-channel-icon">üîó</span>
                                <div class="notify-channel-info">
                                    <span class="notify-channel-name">Webhook</span>
                                    <span class="notify-channel-type">Webhook</span>
                                </div>
                            </label>
                            <label class="notify-channel-item">
                                <input type="checkbox" class="notify-checkbox" value="email">
                                <span class="notify-channel-icon">üìß</span>
                                <div class="notify-channel-info">
                                    <span class="notify-channel-name">ÈÇÆ‰ª∂ÈÄöÁü•</span>
                                    <span class="notify-channel-type">ÈÇÆ‰ª∂</span>
                                </div>
                            </label>
                            <label class="notify-channel-item">
                                <input type="checkbox" class="notify-checkbox" value="wechat">
                                <span class="notify-channel-icon">üí¨</span>
                                <div class="notify-channel-info">
                                    <span class="notify-channel-name">ÂæÆ‰ø°Êé®ÈÄÅ</span>
                                    <span class="notify-channel-type">ÂæÆ‰ø°Êé®ÈÄÅ</span>
                                </div>
                            </label>
                        </div>
                        <p class="notify-settings-hint">üí° ÂèØ‰ª•ÈÄöËøá„ÄåÈÄöÁü•Ê∏†ÈÅì„ÄçÊ∑ªÂä†„ÄÅÁºñËæëÂíåÂà†Èô§ÈÄöÁü•ÈÖçÁΩÆ</p>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">ÂèñÊ∂à</button>
                <button class="btn btn-primary" onclick="saveMonitor()">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <!-- ÈÄöÁü•Ê∏†ÈÅìÁÆ°ÁêÜÊ®°ÊÄÅÊ°Ü -->
    <div class="modal-overlay" id="notifyModal">
        <div class="modal" style="max-width: 650px;">
            <div class="modal-header">
                <h3 class="modal-title">üîî ÈÄöÁü•Ê∏†ÈÅìÁÆ°ÁêÜ</h3>
                <button class="modal-close" onclick="closeNotifyModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="notify-channels-header">
                    <p class="notify-desc">ÁÆ°ÁêÜÈÄöÁü•Ê∏†ÈÅìÔºåÂΩìÁõëÊéßÁä∂ÊÄÅÂèòÂåñÊó∂ÂèëÈÄÅÈÄöÁü•</p>
                    <button class="btn btn-primary btn-sm" onclick="showAddChannel()">+ Ê∑ªÂä†Ê∏†ÈÅì</button>
                </div>
                
                <!-- Ê∏†ÈÅìÂàóË°® -->
                <div class="notify-channels-manage" id="notifyChannelsManage">
                    <div class="empty-channels">ÊöÇÊó†ÈÄöÁü•Ê∏†ÈÅìÔºåÁÇπÂáª‰∏äÊñπÊåâÈíÆÊ∑ªÂä†</div>
                </div>
                
                <!-- Ê∑ªÂä†/ÁºñËæëÊ∏†ÈÅìË°®Âçï -->
                <div class="channel-form" id="channelForm" style="display: none;">
                    <div class="channel-form-header">
                        <h4 id="channelFormTitle">Ê∑ªÂä†ÈÄöÁü•Ê∏†ÈÅì</h4>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Ê∏†ÈÅìÂêçÁß∞ *</label>
                        <input type="text" class="form-input" id="channelName" placeholder="‰æãÂ¶ÇÔºöÊàëÁöÑWebhook">
                    </div>
                    <div class="form-group">
                        <label class="form-label">JavaScript ‰ª£Á†Å</label>
                        <p class="notify-hint">ÂèØÁî®ÂèòÈáèÔºö<code>name</code>(ÁõëÊéßÂêçÁß∞), <code>status</code>(Áä∂ÊÄÅ), <code>message</code>(Ê∂àÊÅØ), <code>time</code>(Êó∂Èó¥)</p>
                        <textarea class="notify-code" id="channelCode" placeholder="// Á§∫‰æãÔºöÂèëÈÄÅÂà∞Webhook
fetch('https://your-webhook-url.com', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
        title: name + ' Áä∂ÊÄÅÂèòÊõ¥',
        content: message,
        status: status,
        time: time
    })
});"></textarea>
                    </div>
                    <div class="channel-form-actions">
                        <button class="btn btn-secondary" onclick="hideChannelForm()">ÂèñÊ∂à</button>
                        <button class="btn btn-warning" onclick="testChannel()">üß™ ÊµãËØï</button>
                        <button class="btn btn-primary" onclick="saveChannel()">‰øùÂ≠òÊ∏†ÈÅì</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ToastÂÆπÂô® -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        // ÂÖ®Â±ÄÂèòÈáè
        let allMonitors = [];
        let selectedTypes = [];
        let currentMonitorId = null;
        let isEditMode = false;
        let currentFilter = 'all';

        const TYPE_INFO = {
            'http': { icon: 'üåê', name: 'HTTP', color: '#58a6ff' },
            'ssl': { icon: 'üîí', name: 'SSLËØÅ‰π¶', color: '#a371f7' }
        };

        // Toast ÈÄöÁü•
        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Âä†ËΩΩÁõëÊéßÊï∞ÊçÆ
        async function loadMonitors() {
            try {
                const response = await fetch('/api/monitors');
                const data = await response.json();
                allMonitors = data.monitors;
                
                document.getElementById('statTotal').textContent = data.stats.total;
                document.getElementById('statOnline').textContent = data.stats.online;
                document.getElementById('statOffline').textContent = data.stats.offline;
                document.getElementById('statUptime').textContent = data.stats.avg_uptime + '%';
                document.getElementById('lastUpdate').textContent = 'Êõ¥Êñ∞‰∫é ' + data.last_update;
                
                renderMonitorCards();
                renderSidebarList();
            } catch (error) {
                console.error('Âä†ËΩΩÂ§±Ë¥•:', error);
                showToast('Âä†ËΩΩÊï∞ÊçÆÂ§±Ë¥•', 'error');
            }
        }
        
        // ÊåâÁä∂ÊÄÅÁ≠õÈÄâ
        function filterByStatus(status) {
            currentFilter = status;
            
            // Êõ¥Êñ∞ÈÄâ‰∏≠Áä∂ÊÄÅ
            document.querySelectorAll('.stat-card').forEach(card => card.classList.remove('active'));
            if (status === 'all') {
                document.getElementById('filterAll').classList.add('active');
            } else if (status === 'online') {
                document.getElementById('filterOnline').classList.add('active');
            } else if (status === 'offline') {
                document.getElementById('filterOffline').classList.add('active');
            }
            
            renderMonitorCards();
        }

        // Ê∏≤ÊüìÁõëÊéßÂç°Áâá
        function renderMonitorCards() {
            const grid = document.getElementById('monitorsGrid');
            
            if (allMonitors.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <div class="empty-state-icon">üì°</div>
                        <h3>ÊöÇÊó†ÁõëÊéßÈ°πÁõÆ</h3>
                        <p>ÁÇπÂáª„ÄåÊ∑ªÂä†ÁõëÊéß„ÄçÂºÄÂßãÁõëÊéß‰Ω†ÁöÑÁΩëÁ´ô</p>
                    </div>
                `;
                return;
            }
            
            // ÊåâIDÊéíÂ∫èÔºàÂÖàÊ∑ªÂä†ÁöÑÂú®ÂâçÈù¢Ôºâ
            const sorted = [...allMonitors].sort((a, b) => a.id - b.id);
            
            // Ê†πÊçÆÁ≠õÈÄâÊù°‰ª∂ËøáÊª§
            let filtered = sorted;
            if (currentFilter === 'online') {
                filtered = sorted.filter(m => m.current_status === 1);
            } else if (currentFilter === 'offline') {
                filtered = sorted.filter(m => m.current_status === 0);
            }
            
            if (filtered.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1/-1;">
                        <div class="empty-state-icon">${currentFilter === 'online' ? '‚úÖ' : '‚ùå'}</div>
                        <h3>Ê≤°Êúâ${currentFilter === 'online' ? 'Ê≠£Â∏∏' : 'ÊïÖÈöú'}ÁöÑÁõëÊéßÈ°π</h3>
                        <p>ÁÇπÂáª„ÄåÁõëÊéßÊÄªÊï∞„ÄçÊü•ÁúãÂÖ®ÈÉ®</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = filtered.map(m => renderCard(m)).join('');
            
            // Âª∂ËøüÁªòÂà∂ÂõæË°®ÔºåÁ°Æ‰øùDOMÂ∑≤Ê∏≤Êüì
            setTimeout(() => {
                filtered.forEach(m => drawChart(m, 50));
            }, 100);
        }

        // Ê∏≤ÊüìÂçï‰∏™Âç°Áâá
        function renderCard(monitor) {
            const isOnline = monitor.current_status === 1;
            const types = monitor.types || ['http'];
            const uptime = monitor.uptime || 100;
            
            // ÁîüÊàêÊ†áÁ≠æ
            const tags = types.map(t => {
                const info = TYPE_INFO[t] || { name: t };
                return `<span class="card-tag type">${info.name}</span>`;
            }).join('');

            // ÁîüÊàêÁä∂ÊÄÅÊù°ÔºàÂÖ®ÈÉ®Â°´Êª°ÔºåÁî®ÂΩìÂâçÁä∂ÊÄÅË°•ÈΩêÔºâ
            const history = monitor.history || [];
            let statusBars = '';
            const totalBars = 50;
            
            // Â¶ÇÊûúÊúâÂéÜÂè≤ËÆ∞ÂΩïÔºåÁî®Á¨¨‰∏ÄÊù°ËÆ∞ÂΩïÁöÑÁä∂ÊÄÅÂ°´ÂÖÖÁ©∫ÁôΩÈÉ®ÂàÜ
            // Â¶ÇÊûúÊ≤°ÊúâÂéÜÂè≤ËÆ∞ÂΩïÔºåÁî®ÂΩìÂâçÁä∂ÊÄÅÂ°´ÂÖÖ
            const fillStatus = history.length > 0 ? history[0].status : (monitor.current_status || 1);
            const emptyBars = Math.max(0, totalBars - history.length);
            
            // ÂÖàÁî®Á¨¨‰∏ÄÊù°ËÆ∞ÂΩïÁöÑÁä∂ÊÄÅÂ°´ÂÖÖÂ∑¶Ëæπ
            for (let i = 0; i < emptyBars; i++) {
                statusBars += `<div class="status-bar ${fillStatus ? 'online' : 'offline'}"></div>`;
            }
            // ÂÜçÂ°´ÂÖÖÊúâËÆ∞ÂΩïÁöÑÔºà‰ªéÊóßÂà∞Êñ∞Ôºâ
            for (let i = 0; i < history.length && i < totalBars; i++) {
                const h = history[i];
                statusBars += `<div class="status-bar ${h.status ? 'online' : 'offline'}"></div>`;
            }

            // Ëé∑ÂèñÂìçÂ∫îÊó∂Èó¥ÁªüËÆ°
            const typeResults = monitor.type_results || {};
            let ltTime = '--', avgTime = '--', maxTime = '--';
            
            // HTTPÁªüËÆ°
            if (typeResults['http']) {
                ltTime = typeResults['http'].response_time || 0;
                avgTime = monitor.avg_response_time || 0;
                const history = typeResults['http'].history || [];
                if (history.length > 0) {
                    maxTime = Math.max(...history.map(h => h.response_time || 0));
                } else {
                    maxTime = ltTime;
                }
            }
            
            // SSLËØÅ‰π¶‰ø°ÊÅØ
            let sslInfo = null;
            if (types.includes('ssl') && typeResults['ssl']) {
                const sslResult = typeResults['ssl'];
                const daysLeft = sslResult.status_code || 0;
                const sslStatus = sslResult.status;
                let sslClass = 'ssl-safe';
                if (daysLeft <= 7) {
                    sslClass = 'ssl-danger';
                } else if (daysLeft <= 30) {
                    sslClass = 'ssl-warning';
                }
                sslInfo = { daysLeft, sslClass, status: sslStatus };
            }

            const uptimeClass = uptime < 90 ? 'danger' : (uptime < 99 ? 'warning' : '');
            
            return `
                <div class="monitor-card">
                    <div class="card-header">
                        <div class="card-title-section">
                            <div class="card-title">
                                <span class="card-status-icon ${isOnline ? 'online' : 'offline'}">${isOnline ? '‚úì' : '!'}</span>
                                ${monitor.name}
                            </div>
                            <div class="card-tags">
                                <span class="card-tag">Core</span>
                                <span class="card-tag method">Method: HTTPS</span>
                            </div>
                            <div class="card-type-line">${tags}</div>
                        </div>
                        <div class="uptime-section">
                            <div class="uptime-ring">
                                <svg width="40" height="40" viewBox="0 0 40 40">
                                    <circle class="uptime-ring-bg" cx="20" cy="20" r="16"/>
                                    <circle class="uptime-ring-progress ${uptimeClass}" 
                                            cx="20" cy="20" r="16" 
                                            stroke-dasharray="${2 * Math.PI * 16}" 
                                            stroke-dashoffset="${2 * Math.PI * 16 - (uptime / 100) * 2 * Math.PI * 16}"/>
                                </svg>
                            </div>
                            <span class="uptime-text ${uptimeClass}">${uptime.toFixed(2)}%</span>
                        </div>
                    </div>

                    ${sslInfo ? `
                    <div class="ssl-section ${sslInfo.sslClass}">
                        <div class="ssl-left">
                            <span class="ssl-icon-large">üîí</span>
                            <span class="ssl-label">SSLËØÅ‰π¶Ââ©‰Ωô</span>
                        </div>
                        <div class="ssl-right">
                            <div class="ssl-days-large">${sslInfo.daysLeft}</div>
                            <div class="ssl-unit">Â§©</div>
                        </div>
                    </div>
                    ` : ''}

                    <div class="card-stats-row">
                        <div class="card-stats">
                            <span class="card-stat">LT:<span class="stat-value-green">${ltTime} ms</span></span>
                            <span class="card-stat">AVG:<span class="stat-value-green">${avgTime} ms</span></span>
                            <span class="card-stat">TA:<span class="stat-value-green">${maxTime} ms</span></span>
                        </div>
                        <div class="status-legend">
                            <span class="legend-item"><span class="legend-dot online"></span>Âú®Á∫ø</span>
                            <span class="legend-item"><span class="legend-dot maintenance"></span>Áª¥Êä§</span>
                            <span class="legend-item"><span class="legend-dot offline"></span>Á¶ªÁ∫ø</span>
                        </div>
                    </div>

                    <div class="status-bar-section">
                        <div class="status-bars">${statusBars}</div>
                    </div>

                    <div class="card-divider"></div>

                    <div class="range-tabs" data-monitor-id="${monitor.id}">
                        <button class="range-tab active" data-range="50" onclick="switchRange(${monitor.id}, 50, this, event)">ÊúÄËøë 50 Ê¨°</button>
                        <button class="range-tab" data-range="25" onclick="switchRange(${monitor.id}, 25, this, event)">ÊúÄËøë 25 Ê¨°</button>
                        <button class="range-tab" data-range="10" onclick="switchRange(${monitor.id}, 10, this, event)">ÊúÄËøë 10 Ê¨°</button>
                    </div>

                    <div class="chart-wrapper">
                        <div class="chart-y-labels" id="yLabels_${monitor.id}">
                            <span>--</span>
                            <span>--</span>
                            <span>--</span>
                        </div>
                        <div class="chart-main">
                            <canvas class="chart-canvas" id="chart_${monitor.id}" width="300" height="80"></canvas>
                            <div class="chart-x-labels" id="xLabels_${monitor.id}">
                                <span>--</span>
                                <span>--</span>
                                <span>--</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // ÂàáÊç¢ËåÉÂõ¥
        function switchRange(monitorId, range, btn, event) {
            // ÈòªÊ≠¢‰∫ã‰ª∂ÂÜíÊ≥°ÔºåÈÅøÂÖçËß¶ÂèëÂç°ÁâáÁÇπÂáª
            if (event) event.stopPropagation();
            
            // Êõ¥Êñ∞ÊåâÈíÆÁä∂ÊÄÅ
            const tabs = btn.parentElement.querySelectorAll('.range-tab');
            tabs.forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            
            // ÈáçÊñ∞ÁªòÂà∂ÂõæË°®
            const monitor = allMonitors.find(m => m.id === monitorId);
            if (monitor) {
                drawChart(monitor, range);
            }
        }

        // ÁªòÂà∂ÂõæË°®
        function drawChart(monitor, range = 50) {
            const canvas = document.getElementById(`chart_${monitor.id}`);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const history = monitor.history || [];
            
            // ÂèñÊúÄËøëNÊù°ËÆ∞ÂΩï
            const data = history.slice(-range).map(h => h.response_time || 0);
            
            if (data.length === 0) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#6e7681';
                ctx.font = '12px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('ÊöÇÊó†Êï∞ÊçÆ', canvas.width / 2, canvas.height / 2);
                return;
            }
            
            // ËÆ°ÁÆóËåÉÂõ¥
            const maxVal = Math.max(...data, 1);
            const minVal = Math.min(...data);
            const padding = (maxVal - minVal) * 0.1 || 10;
            const chartMax = maxVal + padding;
            const chartMin = Math.max(0, minVal - padding);
            
            // Êõ¥Êñ∞YËΩ¥Ê†áÁ≠æ
            const yLabels = document.getElementById(`yLabels_${monitor.id}`);
            if (yLabels) {
                const labels = yLabels.querySelectorAll('span');
                labels[0].textContent = Math.round(chartMax) + ' ms';
                labels[1].textContent = Math.round((chartMax + chartMin) / 2) + ' ms';
                labels[2].textContent = Math.round(chartMin) + ' ms';
            }
            
            // Êõ¥Êñ∞XËΩ¥Ê†áÁ≠æ
            const xLabels = document.getElementById(`xLabels_${monitor.id}`);
            if (xLabels && history.length > 0) {
                const labels = xLabels.querySelectorAll('span');
                const startIdx = Math.max(0, history.length - range);
                const endIdx = history.length - 1;
                const midIdx = Math.floor((startIdx + endIdx) / 2);
                
                const formatTime = (t) => {
                    if (!t) return '--';
                    const parts = t.split(' ');
                    return parts[1] ? parts[1].substring(0, 5) : t;
                };
                
                labels[0].textContent = formatTime(history[startIdx]?.time);
                labels[1].textContent = formatTime(history[midIdx]?.time);
                labels[2].textContent = formatTime(history[endIdx]?.time);
            }
            
            // ÁªòÂà∂
            const width = canvas.width;
            const height = canvas.height;
            const range_val = chartMax - chartMin || 1;
            
            ctx.clearRect(0, 0, width, height);
            
            // ÁªòÂà∂ÁΩëÊ†ºÁ∫ø
            ctx.strokeStyle = 'rgba(48, 54, 61, 0.5)';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 3; i++) {
                const y = (height / 3) * i;
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
            
            // ÁªòÂà∂ÊäòÁ∫ø
            ctx.beginPath();
            ctx.strokeStyle = '#3fb950';
            ctx.lineWidth = 2;
            ctx.lineJoin = 'round';
            ctx.lineCap = 'round';
            
            const stepX = width / (data.length - 1 || 1);
            
            data.forEach((val, i) => {
                const x = i * stepX;
                const y = height - ((val - chartMin) / range_val) * height;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            
            ctx.stroke();
            
            // ÁªòÂà∂Ê∏êÂèòÂ°´ÂÖÖ
            const gradient = ctx.createLinearGradient(0, 0, 0, height);
            gradient.addColorStop(0, 'rgba(63, 185, 80, 0.3)');
            gradient.addColorStop(1, 'rgba(63, 185, 80, 0.0)');
            
            ctx.lineTo(width, height);
            ctx.lineTo(0, height);
            ctx.closePath();
            ctx.fillStyle = gradient;
            ctx.fill();
        }

        // ÂΩìÂâçÈÄâ‰∏≠ÁöÑÁ±ªÂûã
        let currentSelectedType = null;

        // Ê∏≤Êüì‰æßËæπÊ†èÂàóË°® - ÊòæÁ§∫ÂΩìÂâçÁõëÊéßÁöÑÂêÑ‰∏™Á±ªÂûã
        function renderSidebarList() {
            const list = document.getElementById('sidebarList');
            const monitor = allMonitors.find(m => m.id === currentMonitorId);
            
            if (!monitor) {
                list.innerHTML = '<div style="padding: 20px; color: var(--text-muted);">ËØ∑ÈÄâÊã©ÁõëÊéßÈ°πÁõÆ</div>';
                return;
            }

            const types = monitor.types || ['http'];
            const typeResults = monitor.type_results || {};

            list.innerHTML = types.map((t, index) => {
                const info = TYPE_INFO[t] || { icon: 'üåê', name: t };
                const result = typeResults[t];
                const isOnline = result && result.status === 1;
                const isActive = currentSelectedType === t || (currentSelectedType === null && index === 0);
                
                // Â¶ÇÊûúÊ≤°ÊúâÈÄâ‰∏≠ÁöÑÁ±ªÂûãÔºåÈªòËÆ§ÈÄâ‰∏≠Á¨¨‰∏Ä‰∏™
                if (currentSelectedType === null && index === 0) {
                    currentSelectedType = t;
                }
                
                return `
                    <div class="sidebar-item ${isActive ? 'active' : ''}" onclick="selectType('${t}')">
                        <div class="sidebar-item-icon">${info.icon}</div>
                        <div class="sidebar-item-content">
                            <div class="sidebar-item-name">${info.name}ÁõëÊéß</div>
                        </div>
                        <div class="sidebar-item-status ${isOnline ? 'online' : 'offline'}"></div>
                    </div>
                `;
            }).join('');
        }

        // ÈÄâÊã©ÁõëÊéßÁ±ªÂûã
        function selectType(type) {
            currentSelectedType = type;
            renderSidebarList();
            loadTypeDetail(type);
        }

        // ËøáÊª§‰æßËæπÊ†èÈ°πÁõÆ
        function filterSidebarItems() {
            const search = document.getElementById('sidebarSearch').value.toLowerCase();
            const items = document.querySelectorAll('.sidebar-item');
            items.forEach(item => {
                const name = item.querySelector('.sidebar-item-name').textContent.toLowerCase();
                item.style.display = name.includes(search) ? '' : 'none';
            });
        }

        // ÊâìÂºÄËØ¶ÊÉÖÈ°µ
        function openDetail(id) {
            currentMonitorId = id;
            currentSelectedType = null; // ÈáçÁΩÆÈÄâ‰∏≠ÁöÑÁ±ªÂûã
            document.getElementById('homePage').classList.add('hidden');
            document.getElementById('detailPage').classList.add('active');
            loadMonitorDetail(id);
        }

        // Âä†ËΩΩÁõëÊéßËØ¶ÊÉÖ
        async function loadMonitorDetail(id) {
            const monitor = allMonitors.find(m => m.id === id);
            if (!monitor) return;

            document.getElementById('detailTitle').textContent = monitor.name;
            document.getElementById('detailSubtitle').textContent = monitor.target;
            document.getElementById('sidebarTitle').textContent = monitor.name + ' - ÁõëÊéßÁ±ªÂûã';

            // Ê∏≤Êüì‰æßËæπÊ†èÁ±ªÂûãÂàóË°®
            renderSidebarList();

            // ÁªüËÆ°Á±ªÂûãÁä∂ÊÄÅ
            const types = monitor.types || ['http'];
            const typeResults = monitor.type_results || {};
            let onlineCount = 0, offlineCount = 0, unknownCount = 0;

            types.forEach(t => {
                const result = typeResults[t];
                if (!result || result.status === undefined) {
                    unknownCount++;
                } else if (result.status === 1) {
                    onlineCount++;
                } else {
                    offlineCount++;
                }
            });

            document.getElementById('detailOnline').textContent = onlineCount;
            document.getElementById('detailOffline').textContent = offlineCount;
            document.getElementById('detailUnknown').textContent = unknownCount;

            // Âä†ËΩΩÂΩìÂâçÈÄâ‰∏≠Á±ªÂûãÁöÑÂéÜÂè≤
            if (currentSelectedType) {
                loadTypeDetail(currentSelectedType);
            } else if (types.length > 0) {
                currentSelectedType = types[0];
                loadTypeDetail(types[0]);
            }
        }

        // Âä†ËΩΩÁâπÂÆöÁ±ªÂûãÁöÑËØ¶ÊÉÖÂíåÂéÜÂè≤
        async function loadTypeDetail(type) {
            const monitor = allMonitors.find(m => m.id === currentMonitorId);
            if (!monitor) return;

            const typeInfo = TYPE_INFO[type] || { icon: 'üåê', name: type };
            
            try {
                const response = await fetch(`/api/monitors/${currentMonitorId}/logs?limit=50`);
                const data = await response.json();
                
                // ËøáÊª§ÂΩìÂâçÁ±ªÂûãÁöÑÊó•Âøó
                const typeLogs = data.logs.filter(log => log.check_type === type);
                renderHistoryTable(typeLogs, monitor, type);
            } catch (error) {
                console.error('Âä†ËΩΩÂéÜÂè≤Â§±Ë¥•:', error);
            }
        }

        // Ê∏≤ÊüìÂéÜÂè≤Ë°®Ê†º
        function renderHistoryTable(logs, monitor, currentType) {
            const tbody = document.getElementById('historyTableBody');
            const typeInfo = TYPE_INFO[currentType] || { icon: 'üåê', name: currentType || 'HTTP' };
            
            // Êõ¥Êñ∞Ë°®Ê†ºÊ†áÈ¢ò
            document.querySelector('.section-title').innerHTML = `üìã ${typeInfo.name}ÁõëÊéß - Ê£ÄÊµãÂéÜÂè≤`;
            
            if (!logs || logs.length === 0) {
                tbody.innerHTML = `<tr><td colspan="4" style="text-align: center; color: var(--text-muted);">ÊöÇÊó†ËÆ∞ÂΩï</td></tr>`;
                return;
            }

            tbody.innerHTML = logs.map(log => {
                const logTypeInfo = TYPE_INFO[log.check_type] || { icon: 'üåê', name: log.check_type || 'HTTP' };
                const statusClass = log.status === 1 ? 'online' : 'offline';
                const statusText = log.status === 1 ? 'Ê≠£Â∏∏' : 'ÂºÇÂ∏∏';
                
                return `
                    <tr>
                        <td>
                            <div class="table-name">
                                <span>${logTypeInfo.icon}</span>
                                ${logTypeInfo.name}ÁõëÊéß
                            </div>
                        </td>
                        <td>
                            <span class="table-status ${statusClass}">
                                <span style="width:6px;height:6px;border-radius:50%;background:currentColor;"></span>
                                ${statusText}
                            </span>
                        </td>
                        <td class="table-time">${log.created_at}</td>
                        <td class="table-message">${log.response_time}ms - ${log.message || 'OK'}</td>
                    </tr>
                `;
            }).join('');
        }

        // ËøîÂõû‰∏ªÈ°µ
        function goHome() {
            document.getElementById('homePage').classList.remove('hidden');
            document.getElementById('detailPage').classList.remove('active');
            currentMonitorId = null;
        }

        // Âà∑Êñ∞ÂΩìÂâçÁõëÊéß
        async function refreshCurrentMonitor() {
            if (!currentMonitorId) return;
            showToast('Ê≠£Âú®Ê£ÄÊü•...', 'info');
            try {
                await fetch(`/api/monitors/${currentMonitorId}/check`, { method: 'POST' });
                await loadMonitors();
                loadMonitorDetail(currentMonitorId);
                showToast('Ê£ÄÊü•ÂÆåÊàê', 'success');
            } catch (error) {
                showToast('Ê£ÄÊü•Â§±Ë¥•', 'error');
            }
        }

        // ÁºñËæëÂΩìÂâçÁõëÊéß
        function editCurrentMonitor() {
            if (!currentMonitorId) return;
            editMonitor(currentMonitorId);
        }

        // Âà†Èô§ÂΩìÂâçÁõëÊéß
        async function deleteCurrentMonitor() {
            if (!currentMonitorId) return;
            const monitor = allMonitors.find(m => m.id === currentMonitorId);
            if (!confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§„Äå${monitor?.name}„ÄçÂêóÔºü`)) return;
            
            try {
                await fetch(`/api/monitors/${currentMonitorId}`, { method: 'DELETE' });
                showToast('Âà†Èô§ÊàêÂäü', 'success');
                goHome();
                loadMonitors();
            } catch (error) {
                showToast('Âà†Èô§Â§±Ë¥•', 'error');
            }
        }

        // ÂàùÂßãÂåñÁ±ªÂûãÂ§çÈÄâÊ°Ü
        function initTypeCheckboxes() {
            document.querySelectorAll('.type-checkbox').forEach(cb => {
                cb.addEventListener('click', function() {
                    const type = this.dataset.type;
                    if (this.classList.contains('selected')) {
                        this.classList.remove('selected');
                        selectedTypes = selectedTypes.filter(t => t !== type);
                    } else {
                        this.classList.add('selected');
                        selectedTypes.push(type);
                    }
                    updateFormFields();
                });
            });
        }

        // Êõ¥Êñ∞Ë°®ÂçïÂ≠óÊÆµ
        function updateFormFields() {
            // ÁÆÄÂåñÁâàÊú¨ÔºöÂè™ÊúâHTTPÂíåSSLÔºåÊó†ÈúÄÈ¢ùÂ§ñÂ≠óÊÆµ
        }

        // ========== ÈÄöÁü•Ê∏†ÈÅìÂäüËÉΩ ==========
        
        let notifyChannels = [];
        let editingChannelIndex = -1;
        
        // Âä†ËΩΩÈÄöÁü•Ê∏†ÈÅì
        function loadNotifyChannels() {
            const saved = localStorage.getItem('notifyChannels');
            notifyChannels = saved ? JSON.parse(saved) : [];
            renderNotifyChannels();
            renderMonitorNotifyOptions();
        }
        
        // Ê∏≤ÊüìÈÄöÁü•Ê∏†ÈÅìÂàóË°®
        function renderNotifyChannels() {
            const container = document.getElementById('notifyChannelsManage');
            if (notifyChannels.length === 0) {
                container.innerHTML = '<div class="empty-channels">ÊöÇÊó†ÈÄöÁü•Ê∏†ÈÅìÔºåÁÇπÂáª‰∏äÊñπÊåâÈíÆÊ∑ªÂä†</div>';
                return;
            }
            
            container.innerHTML = notifyChannels.map((ch, index) => `
                <div class="channel-item">
                    <div class="channel-item-icon">‚ö°</div>
                    <div class="channel-item-info">
                        <div class="channel-item-name">${ch.name}</div>
                        <div class="channel-item-type">Ëá™ÂÆö‰πâJS</div>
                    </div>
                    <div class="channel-item-actions">
                        <button class="btn-edit" onclick="editChannel(${index})">ÁºñËæë</button>
                        <button class="btn-delete" onclick="deleteChannel(${index})">Âà†Èô§</button>
                    </div>
                </div>
            `).join('');
        }
        
        // Ê∏≤ÊüìÁõëÊéßË°®Âçï‰∏≠ÁöÑÈÄöÁü•ÈÄâÈ°π
        function renderMonitorNotifyOptions() {
            const container = document.getElementById('notifyChannelsList');
            if (notifyChannels.length === 0) {
                container.innerHTML = '<div class="empty-channels" style="padding: 15px;">ÊöÇÊó†ÈÄöÁü•Ê∏†ÈÅìÔºåËØ∑ÂÖàÂú®„ÄåÈÄöÁü•Ê∏†ÈÅì„Äç‰∏≠Ê∑ªÂä†</div>';
                return;
            }
            
            container.innerHTML = notifyChannels.map((ch, index) => `
                <label class="notify-channel-item">
                    <input type="checkbox" class="notify-checkbox" value="${index}">
                    <span class="notify-channel-icon">‚ö°</span>
                    <div class="notify-channel-info">
                        <span class="notify-channel-name">${ch.name}</span>
                        <span class="notify-channel-type">Ëá™ÂÆö‰πâJS</span>
                    </div>
                </label>
            `).join('');
        }
        
        // ÊâìÂºÄÈÄöÁü•Ê∏†ÈÅìÊ®°ÊÄÅÊ°Ü
        function openNotifyModal() {
            hideChannelForm();
            renderNotifyChannels();
            document.getElementById('notifyModal').classList.add('active');
        }
        
        // ÂÖ≥Èó≠ÈÄöÁü•Ê∏†ÈÅìÊ®°ÊÄÅÊ°Ü
        function closeNotifyModal() {
            document.getElementById('notifyModal').classList.remove('active');
            renderMonitorNotifyOptions();
        }
        
        // ÊòæÁ§∫Ê∑ªÂä†Ê∏†ÈÅìË°®Âçï
        function showAddChannel() {
            editingChannelIndex = -1;
            document.getElementById('channelFormTitle').textContent = 'Ê∑ªÂä†ÈÄöÁü•Ê∏†ÈÅì';
            document.getElementById('channelName').value = '';
            document.getElementById('channelCode').value = '';
            document.getElementById('channelForm').style.display = 'block';
        }
        
        // ÈöêËóèÊ∏†ÈÅìË°®Âçï
        function hideChannelForm() {
            document.getElementById('channelForm').style.display = 'none';
            editingChannelIndex = -1;
        }
        
        // ÁºñËæëÊ∏†ÈÅì
        function editChannel(index) {
            editingChannelIndex = index;
            const ch = notifyChannels[index];
            document.getElementById('channelFormTitle').textContent = 'ÁºñËæëÈÄöÁü•Ê∏†ÈÅì';
            document.getElementById('channelName').value = ch.name;
            document.getElementById('channelCode').value = ch.code || '';
            document.getElementById('channelForm').style.display = 'block';
        }
        
        // Âà†Èô§Ê∏†ÈÅì
        function deleteChannel(index) {
            if (confirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™ÈÄöÁü•Ê∏†ÈÅìÂêóÔºü')) {
                notifyChannels.splice(index, 1);
                localStorage.setItem('notifyChannels', JSON.stringify(notifyChannels));
                renderNotifyChannels();
                showToast('ÈÄöÁü•Ê∏†ÈÅìÂ∑≤Âà†Èô§', 'success');
            }
        }
        
        // ‰øùÂ≠òÊ∏†ÈÅì
        function saveChannel() {
            const name = document.getElementById('channelName').value.trim();
            const code = document.getElementById('channelCode').value.trim();
            
            if (!name) {
                showToast('ËØ∑ËæìÂÖ•Ê∏†ÈÅìÂêçÁß∞', 'error');
                return;
            }
            
            if (!code) {
                showToast('ËØ∑ËæìÂÖ• JavaScript ‰ª£Á†Å', 'error');
                return;
            }
            
            const channel = { name, code };
            
            if (editingChannelIndex >= 0) {
                notifyChannels[editingChannelIndex] = channel;
            } else {
                notifyChannels.push(channel);
            }
            
            localStorage.setItem('notifyChannels', JSON.stringify(notifyChannels));
            renderNotifyChannels();
            hideChannelForm();
            showToast('ÈÄöÁü•Ê∏†ÈÅìÂ∑≤‰øùÂ≠ò', 'success');
        }
        
        // ÊµãËØïÊ∏†ÈÅì
        function testChannel() {
            const code = document.getElementById('channelCode').value.trim();
            
            if (!code) {
                showToast('ËØ∑ÂÖàËæìÂÖ• JavaScript ‰ª£Á†Å', 'error');
                return;
            }
            
            const name = 'ÊµãËØïÁõëÊéß';
            const status = 'Á¶ªÁ∫ø';
            const message = 'ËøôÊòØ‰∏ÄÊù°ÊµãËØïÈÄöÁü•ÔºåÁõëÊéßÁä∂ÊÄÅÂ∑≤ÂèòÊõ¥';
            const time = new Date().toLocaleString('zh-CN');
            
            try {
                eval(code);
                showToast('ÊµãËØïÈÄöÁü•Â∑≤ÂèëÈÄÅÔºÅËØ∑Ê£ÄÊü•Êé•Êî∂Á´Ø', 'success');
            } catch (error) {
                showToast('ÊâßË°åÂ§±Ë¥•: ' + error.message, 'error');
            }
        }

        // ========== ÁõëÊéßÁÆ°ÁêÜÂäüËÉΩ ==========
        
        // ÊâìÂºÄÊ∑ªÂä†Ê®°ÊÄÅÊ°Ü
        function openAddModal() {
            isEditMode = false;
            document.getElementById('modalTitle').textContent = 'Ê∑ªÂä†ÁõëÊéß';
            document.getElementById('monitorForm').reset();
            document.getElementById('monitorId').value = '';
            selectedTypes = [];
            document.querySelectorAll('.type-checkbox').forEach(cb => cb.classList.remove('selected'));
            updateFormFields();
            document.getElementById('monitorModal').classList.add('active');
        }

        // ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
        function closeModal() {
            document.getElementById('monitorModal').classList.remove('active');
        }

        // ÁºñËæëÁõëÊéß
        async function editMonitor(id) {
            const monitor = allMonitors.find(m => m.id === id);
            if (!monitor) return;

            isEditMode = true;
            document.getElementById('modalTitle').textContent = 'ÁºñËæëÁõëÊéß';
            document.getElementById('monitorId').value = id;
            document.getElementById('monitorName').value = monitor.name;
            document.getElementById('monitorTarget').value = monitor.target;
            document.getElementById('monitorInterval').value = monitor.interval;
            document.getElementById('monitorTimeout').value = monitor.timeout;

            selectedTypes = monitor.types || ['http'];
            document.querySelectorAll('.type-checkbox').forEach(cb => {
                if (selectedTypes.includes(cb.dataset.type)) {
                    cb.classList.add('selected');
                } else {
                    cb.classList.remove('selected');
                }
            });
            updateFormFields();
            document.getElementById('monitorModal').classList.add('active');
        }

        // ‰øùÂ≠òÁõëÊéß
        async function saveMonitor() {
            const id = document.getElementById('monitorId').value;
            const name = document.getElementById('monitorName').value;
            const target = document.getElementById('monitorTarget').value;

            if (!name || !target) {
                showToast('ËØ∑Â°´ÂÜôÂøÖÂ°´Â≠óÊÆµ', 'error');
                return;
            }

            if (selectedTypes.length === 0) {
                showToast('ËØ∑ÈÄâÊã©ÁõëÊéßÁ±ªÂûã', 'error');
                return;
            }

            const data = {
                name,
                types: selectedTypes,
                target,
                interval: parseInt(document.getElementById('monitorInterval').value) || 60,
                timeout: parseInt(document.getElementById('monitorTimeout').value) || 30
            };

            try {
                const url = id ? `/api/monitors/${id}` : '/api/monitors';
                const method = id ? 'PUT' : 'POST';
                const response = await fetch(url, {
                    method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    showToast(id ? 'Êõ¥Êñ∞ÊàêÂäü' : 'ÂàõÂª∫ÊàêÂäü', 'success');
                    closeModal();
                    loadMonitors();
                    if (currentMonitorId) {
                        loadMonitorDetail(currentMonitorId);
                    }
                } else {
                    const err = await response.json();
                    showToast(err.error || '‰øùÂ≠òÂ§±Ë¥•', 'error');
                }
            } catch (error) {
                showToast('‰øùÂ≠òÂ§±Ë¥•', 'error');
            }
        }

        // ========== ‰∏ªÈ¢òÂàáÊç¢ ==========
        function toggleTheme() {
            const html = document.documentElement;
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            // Êõ¥Êñ∞ÊåâÈíÆÂõæÊ†á
            document.getElementById('themeBtn').textContent = newTheme === 'light' ? '‚òÄÔ∏è' : 'üåô';
        }
        
        // Âä†ËΩΩ‰øùÂ≠òÁöÑ‰∏ªÈ¢ò
        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('themeBtn').textContent = savedTheme === 'light' ? '‚òÄÔ∏è' : 'üåô';
        }

        // ========== Ëá™Âä®Âà∑Êñ∞ÊéßÂà∂ ==========
        const REFRESH_INTERVAL = 60; // 60ÁßíÂà∑Êñ∞‰∏ÄÊ¨°
        let refreshCountdown = REFRESH_INTERVAL;
        let isPaused = false;
        let refreshTimer = null;
        
        function updateRefreshUI() {
            const progress = ((REFRESH_INTERVAL - refreshCountdown) / REFRESH_INTERVAL) * 100;
            document.getElementById('refreshProgress').style.width = progress + '%';
            document.getElementById('refreshCountdown').textContent = isPaused ? 'Â∑≤ÊöÇÂÅú' : `Â∞ÜÂú® ${refreshCountdown} ÁßíÂêéÂà∑Êñ∞`;
        }
        
        function startRefreshTimer() {
            refreshTimer = setInterval(() => {
                if (!isPaused) {
                    refreshCountdown--;
                    updateRefreshUI();
                    
                    if (refreshCountdown <= 0) {
                        loadMonitors();
                        refreshCountdown = REFRESH_INTERVAL;
                        document.getElementById('lastRefreshTime').textContent = new Date().toLocaleString('zh-CN');
                    }
                }
            }, 1000);
        }
        
        function togglePause() {
            isPaused = !isPaused;
            document.getElementById('pauseIcon').textContent = isPaused ? '‚ñ∂' : '‚è∏';
            document.getElementById('pauseText').textContent = isPaused ? 'ÁªßÁª≠' : 'ÊöÇÂÅú';
            document.getElementById('pauseBtn').classList.toggle('paused', isPaused);
            updateRefreshUI();
        }
        
        function manualRefresh() {
            loadMonitors();
            refreshCountdown = REFRESH_INTERVAL;
            document.getElementById('lastRefreshTime').textContent = new Date().toLocaleString('zh-CN');
            updateRefreshUI();
            showToast('Âà∑Êñ∞ÊàêÂäü', 'success');
        }

        // Âä†ËΩΩÁΩëÁ´ôËÆæÁΩÆ
        async function loadSiteSettings() {
            try {
                const response = await fetch('/api/settings');
                const settings = await response.json();
                
                // Êõ¥Êñ∞È°µÈù¢Ê†áÈ¢ò
                if (settings.site_title) {
                    document.title = settings.site_title;
                    const logo = document.querySelector('.logo');
                    if (logo) {
                        logo.textContent = (settings.site_icon || 'üöÄ') + ' ' + settings.site_title;
                    }
                }
                
                // Êõ¥Êñ∞Â∫ïÈÉ®‰ø°ÊÅØ
                if (settings.footer_author) {
                    document.getElementById('footerAuthor').textContent = settings.footer_author;
                }
                
                // Êõ¥Êñ∞Â§áÊ°à‰ø°ÊÅØ
                const icpEl = document.getElementById('footerIcp');
                if (settings.footer_icp) {
                    if (settings.footer_url) {
                        icpEl.innerHTML = `<a href="${settings.footer_url}" target="_blank">${settings.footer_icp}</a>`;
                    } else {
                        icpEl.textContent = settings.footer_icp;
                    }
                }
            } catch (e) {
                console.error('Âä†ËΩΩËÆæÁΩÆÂ§±Ë¥•', e);
            }
        }

        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            loadTheme();
            initTypeCheckboxes();
            loadNotifyChannels();
            loadMonitors();
            loadSiteSettings();
            document.getElementById('lastRefreshTime').textContent = new Date().toLocaleString('zh-CN');
            startRefreshTimer();
        });

        // ESC ÂÖ≥Èó≠Ê®°ÊÄÅÊ°Ü
        document.addEventListener('keydown', e => {
            if (e.key === 'Escape') closeModal();
        });

        document.getElementById('monitorModal').addEventListener('click', function(e) {
            if (e.target === this) closeModal();
        });
        
        document.getElementById('notifyModal').addEventListener('click', function(e) {
            if (e.target === this) closeNotifyModal();
        });
    </script>
</body>
</html>
